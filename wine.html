<html>
  <head>
    <title>와인 라벨 인지 테스트</title>
  <body>
    <label for="avatar">본 페이지는 와인 라벨 인지를 위해 지도학습한 결과를 테스트한다.</label> <br/>
    <label for="avatar">현재까지 학습한 와인 라벨은 "루이막스샤블리", "루이미쉘쁘띠샤", "루이자도부르고뉴샤도네", "조르쥬되뵈프보", "샤또오르비옹2009" 이며, 이외의 와인 라벨은 인지하지 못한다.</label> </br><p>
    <label for="avatar">와인 라벨 이미지 업로드: (테스트할 와인 라벨 이미지를 로컬PC에 준비 -> 아래 버튼을 클릭하여 이미지 업로드)</label> <p/>
    <label for="avatar">테스트 이미지 사이즈는 4MB 이하여야 합니다.</label><p/>
    <input type="file" accept="image/*" onchange="loadFile(event)">
    <img id="output"/> <p>
    <div id="responseData"/>
    <script>
      var loadFile = function(event) {
        var output = document.getElementById('output');
        output.src = URL.createObjectURL(event.target.files[0]);
        output.onload = function() {
          URL.revokeObjectURL(output.src) // free memory
        }

        var input = document.querySelector('input[type="file"]')
        var data = new FormData()
        data.append('file', input.files[0])

        fetch('https://winelabeltest-prediction.cognitiveservices.azure.com/customvision/v3.0/Prediction/9d254d5b-3c61-46c8-bfc5-c9f4b3a8f190/classify/iterations/Iteration4/image', {
          method: 'POST',
          headers: {
            "Accept":"application/json",
            "Prediction-Key":"21bdfa68368e447bbd1ce2f6c36b487b"
          },        
          body: data
        }).then((response) => response.json())
        .then((json) => insertData(json));
      };

      function insertData(json) {
        var outputDiv = document.getElementById('responseData');
        var responseData = "";
        for(i=0;i<json.predictions.length;i++) {
            responseData += "<br/>" + "와인 브랜드 : " + json.predictions[i].tagName + " / " + "정확도 : " + json.predictions[i].probability*100; + " % <br/>";
        }

        outputDiv.innerHTML = responseData;
      }
    </script>
  </body>
</html>
