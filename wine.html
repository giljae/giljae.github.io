<html>
  <head>
    <title>맥주 라벨 인지 테스트</title>
  <body>
    <label for="avatar">본 페이지는 와인 라벨 인지를 위해 선행적으로 맥주 라벨로 학습한 결과를 보여준다.</label> </br/>
    <label for="avatar">현재까지 학습한 맥주 라벨은 "하이네켄", "테라", "클라우드", "버드와이저" 이며, 이외의 맥주라벨은 인지하지 못한다.</label> </br><p>
    <label for="avatar">맥주 라벨 이미지 업로드:</label> <br/>
    <input type="file" accept="image/*" onchange="loadFile(event)">
    <img id="output"/> <p>
    <div id="responseData"/>
    <script>
      var loadFile = function(event) {
        var output = document.getElementById('output');
        output.src = URL.createObjectURL(event.target.files[0]);
        output.onload = function() {
          URL.revokeObjectURL(output.src) // free memory
        }

        var input = document.querySelector('input[type="file"]')
        var data = new FormData()
        data.append('file', input.files[0])

        fetch('https://wine-prediction.cognitiveservices.azure.com/customvision/v3.0/Prediction/7effab5c-7851-4883-a1e5-2c14a8995cca/classify/iterations/Iteration5/image', {
          method: 'POST',
          headers: {
            "Accept":"application/json",
            "Prediction-Key":"fb47226f51c747d693c1e9661df7f4d4"
          },        
          body: data
        }).then((response) => response.json())
        .then((json) => insertData(json));
      };

      function insertData(json) {
        var outputDiv = document.getElementById('responseData');
        var responseData = "";
        for(i=0;i<json.predictions.length;i++) {
            responseData += "<br/>" + "맥주 브랜드 : " + json.predictions[i].tagName + " / " + "정확도 : " + json.predictions[i].probability*100; + " % <br/>";
        }

        outputDiv.innerHTML = responseData;
      }
    </script>
  </body>
</html>
